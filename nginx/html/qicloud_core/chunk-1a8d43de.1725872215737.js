(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1a8d43de"],{"11a1":function(e,t,i){},"160b":function(e,t,i){"use strict";const a=[{value:1,label:"入库"},{value:2,label:"在役"},{value:3,label:"故障"},{value:4,label:"报废"}];t["a"]=a},"18a2":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAFk0lEQVR4nO2aS3LbRhCGfzBZpLwRfYLQJxB1AtEnMLNxHosIPIGZEwQ6geUTAMwiD29EnUDkCUSfQMwJLG2SLGIhH0tgiiAGxAxeZEr5qrq6VRZ7Gv/0PAjL0xPnfwGwvfB1GL+NpTHhiuD9yDvHt46Htc43Yew/SCHhJl8hwhTfKnsRgNmfxtIrwk0mCOCrZfYiwOswnkk6xTaZI8BALXMwAlDI1W8jb0jYKozbDq8n8Zn3oEEs9flxZSYWFLSIO5q9P/Mm/Nw4HtYYfhh3/5DeEI6xLubCHXbxTHoXjbxV3AiNCbCacT3ogrCLVeFOHY2b6ggPq5Vk1kPCIVYnU7phVHc31CpA8vDXhH2sCRaI8LJOEWoTwPLh77Hpyjq09hc8ELH+4jNcjLqEw8SOsDxqFaE2ATjabnB9zMQ9AwUccxfEhXBRGsf8vvKFWHBnOMFXhrqqQ8EXFPyG0MScGRu6zljSUVPCUywDhb9D0DFhJchTDe71A9r3mtDEhJnyVQE6K5J0hpmo/P2hkgDJLN0Q9pSl8sOv2SHCHd31wrW7NvGw0lBYIOlHbJsPFDaoUtgmidAzScfYNucIHagkpQWg9Xu0/g1hF0vRYVZ+HXlL1Ugy3oLwCEtRZbzSAjD7kcxtWWlGdsGYgcwdN2FMXyUoJUDSkreEXexfSPY7O3NPDcKJs4ylLwlTsOSel1lyHuZM3kx0uKrSipEahKXgsxRCwm3O6YJAjpQV4BbX0wZeC7O/JqcLlgjwAu+EhznBww9xl1gKEv2AABeEjbOjC5zvBdTtBgJEMmx+ZddgGZI9aKnsiTBBAF8OlBHgI66LbeI8cFWoI1J2Iu6o4zneGicBGHSIu8S2cW69quTV0nHciJ0EYPMxfem55+G7+NZBhDvcEbaJUzc6CcCAt7ie0jgNWCfUEym7DJxOAw+zgp23x857S5ii49hydYIAQ9wlluJz6eTnkbcgLMRFAB8BQsIUCPACAZbaA8lp8JEwBQ9lfSTzu3aY1j8fbu3ykwddsMAdY5tYL0sPs4KBbnB9bBPrgZrCNDFgvQ94mBUIwDhp+LB1qzVF3tK0vZjxDMUwyIBBrglTdHg7y/qfaY98F8b9vx/fS6Swrc1WAB8BQsIUtJnV55vG1J1wTn2BCrB6AAYItPX1lw/ufQNcQ30zZd8eTxDAVwEeVkjOAHMGGOgAoL5I2QuRVX22AqzWWB/b5JwBAh0A1Bdoq0PB6ouRrQAxLgUf3PsJsIb6hrhLLAUCUOZuCn8h77bVsdxl24BNesAmfU2YwqbGQgHykrvct9uALohxKRoVwKa92sQkAAUWLlN+ZzckDpTdYA5OAK7EphelhRt14UOYBOBDB3MHWEOdM2WP6mYEgDmJBzogqHOmrACFdRYKQGtN4+xfdRYmbhsEiFTiMlQoAIlnKqFs21BnoBKdWlaAcxIHOiCoM9B/SYBvf4pPHz49Xq87n2nxy/fenLA01BkoK0DhabXzH5M/dgwk9ZSmtAAUOsS9xXpKsxTnNnmneGfIG8ggALch/9mDrvJejniYERLe4PqYiVICcKnyuVSFhLlwextxe4vkCPUGMgnwyJI3RCcmEYwCWBTqLAA5B+S8JiwEEV4iwkwOkN8nf0iYh7FmowAcfeP4sU3zMCbbBTmn5HxFWAhFXXHRGhJaU6sAJOuRbEF4hJkwJtsFLRrjrCG/sbY8yB8ofwnkfnnLHWT1svGTFMTZ/wletWhEi0ZygAJJZY+rAEyaz6T5MkC9AfXOZMBpkCo0LUBZWhlkBQIscMeYDR8QoI9vnNYESFo0JCyElh3RspFaoDUBVtAFM2VvldvMmf2BWqJVAVbvF/9kA43zj8MJF5ax6cLSFK0KsIblMGA5+JJ6Ao8jF5vS9jO1DOM+bZ68AP8ArUZyX+DB2PYAAAAASUVORK5CYII="},"1a95":function(e,t,i){"use strict";i("e872")},"1c66":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAGLUlEQVR4nO2aTXbaSBDHq5lsMhs7J4hyAtsniHwC4818ZDEWN8AnSHMCkxNIzGK+NiYnMJzA9glgboA3M5tJNL8GiSDRLQkQ9gP79169LrBUXf2v7laLRMkzp1SAIIwP/23Ie1x5/VWGUUtNcPeGQgE+hPHxfyLXuJ7MGL8SOf+tpe7w9wKFWUkGf4N7iC0yQYTTfRHBKsBPYex/nVX+ELOxNyIsCcDgAwYf4paxFyJkBFhh8Ck7L8JcgDUGn7LTIkwF2GDwKTsrgvoxjNuxyBX+pky+F3m3a+cE9UMYj2g9qQElcvlnS3VxdwYjwIT2AKuDzl8tpWWHMEugH4uc4S9yjx1hNobYWEQusAzsAyeb7APTYzdxY84fDfr5o6UGsmUUG6DPBtjHP8AMQ9Zy8x+RLv4FlqdHlQNmTiQLfyfhFglHsia2k6cSiVhSLdytoTDzFPAQ4ZhBTBjEQCD57g43FWYK15ym1yRJe3x3x3dj2QAEHdF4koPY8/62gcKcIIIfi7SxMz6aZaGpfp+2VugnQOwQdwkS/MQsaONuBeI/Pa7qJ9wh+gntVlDYk8LgtYh8xJywJ73Z1vmiVAASbNIcceHkNRtgnYmYXZ/NdoR7iBVxzizo09YO43LDIzKMyVO+MaYaJ3WJgLhaSqqf0EEALVvAKQDJNWmusQzcUMumtEL1DUME8GULMB47CKDFXp1akimIb4U+nblugjNoQYIbC8Bjz+OxN8KtzLbOA08iALEjWThFVqRDv1pq5tEFqFD9HnaB5dmoXxcKs7ItAYgbiX2Aht4r3kE4Xt/iL0G/znzXxRmQR6A5Al/h5umRSCBrkLw73OJaafCDCut8jEgTPh5gGRBno7dNG04BzGOKV9M7RHjLx5QHkvDXTQJRb2LuFztzYbmuz3VnuBlI9pJHcBe3NojpJhFBk8wxH8cNfFMhWQPWvs/av8G1Quxp9QUQoB1bZh/JfkaAJq6Vn3+N38df5O80ThWI+TgwqErVN3xwL5UJ172hzZCIG+J6MqPPdee0pShs6yQJ3uBaaSxUP6XqPlAQu4MIWkooFIDgXjx7EnjCEviOY/Bi51VhMLc0x5iNHokGkoMZ048r7ANc55pZlX6lJp4ds/5tZ/V8BcpAxIAKhbhWGiSZr76BgbXjkn0AYU17jbnoIK6WAohnh+BaZtXPwA3zBKpAnBGNJxYUM4pYbdwlCvaBMYN6R1sYO6F0FijMCsG1WASAIQn4UoGS6j+QnFeUHDmYvx1gGcysofELYs9RBSIb+LsdOteyoQDEGNF4YqdDHC0FsAz6sWUfQIAWg/+I60kFuN66zAwKs0LyWmad5BmSuC8lFNxvKK2+AQHasWUfAHPfIVaVHjkHYmErArg20AU6xNBSQsE+sDINxyxYWQBu+MyaauI6cd2bUKn6KcQy1x1gVXjAXNf2ED2QHIzHjkv9BusPJSNxUFf1UxAgEvfbY55zLBKHCOR+Su4DWcApgCHZxbu4acDS5ElYS03VNyQ5hLhlDMnNL+qfwQ6Yvae4cxRWipkNVQ4/JOuR7AjXRYcktaxAhZhT0uomM3As34qWIb1OEioJUBXUj8Q9XVeufgpPg3GcfS3PM0RYXxLIQ0vFWaCwQkz1vzTkbUPJ5Pdf1JCvrFSoVIcktawBA4rELexSVctmAcz/oUVhTlD+KuYfR3GncHFGvUVKkly7+gbEDRA3xLUxZDC+5Ci5Z36cVpgVAvgEuMHNwA2XiNDFzYAAdzRHmI0OHWpZE3LxyGWEu0S++otQwKKlM50FjMcOA9JiX0dDbvQlB531Y8uxFTaqfgr5DERm/2l7AWsuKQgXIFyIa6PDvbo2AejMp7Mb3AxUqEWFItkQ4nvE7+MeYYZ7YjeJPZYCKIx1FnDvKfcOahPAQJIBSXZxD7AHOmnTSSQ1Ql5N4k6IO5AKmOtprrE5DPoTy7iNa3w73KhlRQEMiOCJiFc1wcfAPMk41TZxTeXH5BZJQu0C7BovAmBWXgR4EeBFAC0vAlgFGMvsR4ed5hW/bJlX/HUE2CfOn7sA7hnAGbod23+S3iucAlT4UWEfuHcKYHgGy+C8UAADLzfmDS+QPYJBT7AuL0UD2ufN/wTUIHAbE730AAAAAElFTkSuQmCC"},"1d7d":function(e,t,i){"use strict";i("411c")},"30da":function(e,t,i){"use strict";i("11a1")},3272:function(e,t,i){"use strict";t["a"]={DJI_M210V2:{value:"经纬 M210 V2",label:"经纬 M210 V2"},DJI_M300RTK:{value:"经纬 M300 RTK",label:"经纬 M300 RTK"},DJI_M30:{value:"经纬 M30",label:" 经纬 M30"},DJI_Mavic2_hangye:{value:"御 Mavic 2 行业版",label:" 御 Mavic 2 行业版"},DJI_Mavic2_bianjiao:{value:"御Mavic 2变焦版",label:"御Mavic 2变焦版"},DJI_Phantom4Pro:{value:"精灵 Phantom 4 Pro",label:"精灵 Phantom 4 Pro"},DJI_Mavic2_hangyejinjie:{value:"御 2 行业进阶版",label:"御 2 行业进阶版"},DJI_AIR_2S:{value:"DJI AIR 2S",label:"DJI AIR 2S"},DH_X820:{value:"大华 X820",label:"大华 X820"},DH_X1550:{value:"大华 X1550",label:"大华 X1550"},DJI_MAVICE3_E:{value:"DJI_MAVICE3_E",label:"Mavic 3E"},DJI_MAVICE3_T:{value:"DJI_MAVICE3_T",label:"Mavic 3T"}}},"3f74":function(e,t,i){e.exports=i.p+"img/over_icon.4dba895f.png"},"411c":function(e,t,i){},"45d9":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAACnUlEQVR4nO2awW0TQRSG/7VzQFxwB5gKcCrArgDnAoiTtwJCBdABoYINFwRc4lTAUkFMBXE6SC4gJJzlG8WWYo8DxmjeEvt90tM87SE779PO2/FOMi3hSVGdMHSIjYFCy4951iOdIyMiEFAxbByf8iyqN7oQcAEuYMsFPC2qMQbuk24MFHpGE2xrgYzYalwAsdW4AKIWBkXV+iZ9ZgIjmlPOpVrIiFrgVXvE0CfUkPIPeXaoGqhFAMW/lvSKmHG+I/Xe59mI3BRzAc+KqnvJo0+6yPiutHuYZ+fkZpgKoPg2xZ+QtogIJrP0F1tKMsKEWdMj7RA3woTeImGf1ATuZwPb66LCg1Zjj337kDE5JgIofp/i35CuillTTC7geVF1fl6t+79lRFPspW6KSQVM1/0paYtYhyFLYY8xGUkF8OgPK+kx6dqk3iQlFRBee5LaWuDy6m0QQbE9hjnusBRSLoOMMIedYMUQweNuPh/zGwZcgAtwAS6AIcIFuAAXYD4f8xsGXIALcAEugCHCBbgAF2A+H/MbBlyAC9gSAeGz+I+mHpLOMZmo1BKaTXW1QDXRGV+Fx0pEUgF8FR7wBbggXRsmeMxZYZ80Cfz9tPzj2cAFp0PtW/1ZPCwDTodKKV4Kf2JH2k19PphcQGB6PlhKukesRCPxidAMEwEBOn+f4YhYhXe8EQYywExAgH5wQD94Qfo7vrLuuynX/XVMBQR4EkpJj4hlXDSkDo/+WEaYCwhN8TsHntWSf8am+B7FlzLEXEBgWVNkIi953x+QmsJ96+H6JolJHFN8n9Qc7l0f06bYtWx6i9Qq4H/ABRBbjQsgItisnDK0tVmM2V4/YJwjIyIQUDFsHAiI6o0uBFyAC3ABpW7+xXZb+YKArhb4BQbpH1D8+qc7AAAAAElFTkSuQmCC"},"69e4":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"site-list-wrap has-padding"},[t("el-card",[t("el-title",{attrs:{slot:"header"},slot:"header"},[e._v(" 站点列表 ")]),t("ContainerHeader",{attrs:{"handle-show-tutorial":e.handleShowTutorial,"handle-click-add":e.handleClickAdd}}),t("SourceTable",{attrs:{source:e.siteList,"handle-open-edit-form":e.handleAddEquipment,"handle-set-media-server-config":e.handleSetMediaServerConfig,"handle-edit":e.handleEdit,"handle-delete-site":e.handleDeleteSite,"handle-open-map":e.handleOpenMap,"handle-open-site-device-source-dialog":e.handleOpenSiteDeviceSourceDialog}}),t("el-row",{staticClass:"sorter-wrap"},[t("el-pagination",{staticClass:"x-pagination float-right",attrs:{background:"",layout:"total, prev, pager, next, jumper","current-page":e.tableConfig.page,"page-size":e.tableConfig.size,total:e.tableConfig.total},on:{"current-change":e.handleChangeCPage}})],1)],1),t("el-dialog",{staticClass:"protective-line",attrs:{center:"",visible:e.dialogLineVisible,width:"70%","close-on-click-modal":!1},on:{close:function(t){return e.resetForm("SiteDetailsForm")}}},[t("el-title",{attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.isEdit?e.disabled?"详情":"编辑":"新建")+" ")]),t("el-form",{ref:"SiteDetailsForm",attrs:{size:"small",disabled:e.disabled,"label-position":"right","label-width":"170px",model:e.siteDetails,rules:e.siteRules}},[t("h2",{staticClass:"floor-title"},[e._v(" 基本信息 ")]),t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"站点编号"}},[t("el-input",{attrs:{disabled:e.isEdit},model:{value:e.siteDetails.siteID,callback:function(t){e.$set(e.siteDetails,"siteID",t)},expression:"siteDetails.siteID"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"站点名称",prop:"siteName"}},[t("el-input",{model:{value:e.siteDetails.siteName,callback:function(t){e.$set(e.siteDetails,"siteName",t)},expression:"siteDetails.siteName"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"站点地址",prop:"siteAddress"}},[t("el-input",{model:{value:e.siteDetails.siteAddress,callback:function(t){e.$set(e.siteDetails,"siteAddress",t)},expression:"siteDetails.siteAddress"}})],1)],1)],1),t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"地理位置",prop:"siteLocation"}},[t("InputAppend",[t("el-input",{attrs:{placeholder:"121.1234567,31.12345678"},model:{value:e.siteDetails.siteLocation,callback:function(t){e.$set(e.siteDetails,"siteLocation",t)},expression:"siteDetails.siteLocation"}}),t("i",{staticClass:"el-icon-location",attrs:{slot:"input-append"},on:{click:function(t){return e.handleOpenMap(e.siteDetails.siteLocation,e.CLICKMODE.sitemarker,e.siteDetails.siteID)}},slot:"input-append"})],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"设备配置",prop:"siteMode"}},[t("el-select",{model:{value:e.siteDetails.siteMode,callback:function(t){e.$set(e.siteDetails,"siteMode",e._n(t))},expression:"siteDetails.siteMode"}},e._l(e.SITEMODEL,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"多机配置",prop:"isMultipleUAV"}},[t("el-select",{model:{value:e.siteDetails.isMultipleUAV,callback:function(t){e.$set(e.siteDetails,"isMultipleUAV",e._n(t))},expression:"siteDetails.isMultipleUAV"}},e._l(e.multipleOptions,(function(e){return t("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})})),1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"相对地面高度",prop:"siteAltitude"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.siteAltitude,callback:function(t){e.$set(e.siteDetails,"siteAltitude",t)},expression:"siteDetails.siteAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v(" m")])],1)],1)],1)],1),t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"海拔高度"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.siteHAltitude,callback:function(t){e.$set(e.siteDetails,"siteHAltitude",t)},expression:"siteDetails.siteHAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v(" m")])],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"椭球高度"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.siteEllipsAltitude,callback:function(t){e.$set(e.siteDetails,"siteEllipsAltitude",t)},expression:"siteDetails.siteEllipsAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v(" m")])],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"上传图片"}},[e.siteDetails.thumbnailBase64?t("el-button",{attrs:{type:"text",icon:"el-icon-picture-outline"},on:{click:function(t){e.imgCropperDialogVisible=!0}}},[e._v(" "+e._s(e.siteDetails.siteName)+" ")]):t("el-button",{on:{click:function(t){e.imgCropperDialogVisible=!0}}},[t("i",{staticClass:"el-icon-upload"}),e._v(" 上传图片 ")])],1)],1)],1),t("h2",{staticClass:"floor-title"},[e._v(" 飞行器安全配置 ")]),t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"飞行模式",prop:"siteSFMode"}},[t("el-select",{model:{value:e.siteDetails.siteSFMode,callback:function(t){e.$set(e.siteDetails,"siteSFMode",t)},expression:"siteDetails.siteSFMode"}},[t("el-option",{attrs:{value:1,label:"孤岛模式"}}),t("el-option",{attrs:{value:2,label:"跳棋模式"}})],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"无人机起飞高度"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.UAVSTAltitude,callback:function(t){e.$set(e.siteDetails,"UAVSTAltitude",t)},expression:"siteDetails.UAVSTAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v(" m")])],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"是否自定义备降",prop:"siteOptionMode"}},[t("el-select",{on:{change:e.handleChangeSiteOptionModeType},model:{value:e.siteDetails.siteOptionMode,callback:function(t){e.$set(e.siteDetails,"siteOptionMode",e._n(t))},expression:"siteDetails.siteOptionMode"}},[t("el-option",{attrs:{value:2,label:"否"}}),t("el-option",{attrs:{value:1,label:"是"}})],1)],1)],1),1===e.siteDetails.siteOptionMode?[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"备降位置",prop:"siteOptionLocation"}},[t("InputAppend",[t("el-input",{attrs:{placeholder:"例如：121.1234567,31.12345678"},model:{value:e.siteDetails.siteOptionLocation,callback:function(t){e.$set(e.siteDetails,"siteOptionLocation",t)},expression:"siteDetails.siteOptionLocation"}}),t("i",{staticClass:"el-icon-location",attrs:{slot:"input-append",disabled:""},on:{click:function(t){return e.handleOpenMap(e.siteDetails.siteOptionLocation,e.CLICKMODE.landingmarker,e.siteDetails.siteID)}},slot:"input-append"})],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"备降点相对地面高度",prop:"siteOptionAltitude"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.siteOptionAltitude,callback:function(t){e.$set(e.siteDetails,"siteOptionAltitude",t)},expression:"siteDetails.siteOptionAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v(" m")])],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"备降点椭球高度"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.siteOptionEllipsAltitude,callback:function(t){e.$set(e.siteDetails,"siteOptionEllipsAltitude",t)},expression:"siteDetails.siteOptionEllipsAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v(" m")])],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"备降点海拔高度",prop:"siteOptionHAltitude"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.siteOptionHAltitude,callback:function(t){e.$set(e.siteDetails,"siteOptionHAltitude",t)},expression:"siteDetails.siteOptionHAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v("m")])],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"备降点返航高度",prop:"siteOptionRHAltitude"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.siteOptionRHAltitude,callback:function(t){e.$set(e.siteDetails,"siteOptionRHAltitude",t)},expression:"siteDetails.siteOptionRHAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v(" m")])],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"备降点悬停高度",prop:"siteOptionHoverAltitude"}},[t("InputAppend",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.siteOptionHoverAltitude,callback:function(t){e.$set(e.siteDetails,"siteOptionHoverAltitude",t)},expression:"siteDetails.siteOptionHoverAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v("m")])],1)],1)],1)]:e._e(),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"起飞点返航高度",prop:"siteRHAltitude"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.siteRHAltitude,callback:function(t){e.$set(e.siteDetails,"siteRHAltitude",t)},expression:"siteDetails.siteRHAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v(" m")])],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"起飞点降落悬停高度",prop:"siteRHHoverAltitude"}},[t("input-append",{attrs:{type:"text"}},[t("el-input",{model:{value:e.siteDetails.siteRHHoverAltitude,callback:function(t){e.$set(e.siteDetails,"siteRHHoverAltitude",t)},expression:"siteDetails.siteRHHoverAltitude"}}),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[e._v(" m ")])],1)],1)],1),e._e()],2),t("h2",{staticClass:"floor-title"},[e._v(" 实时视角配置 ")]),t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"播流配置"}},[t("el-input",{attrs:{placeholder:"请输入播流IP地址或域名"},model:{value:e.siteDetails.videoPullAddr,callback:function(t){e.$set(e.siteDetails,"videoPullAddr",t)},expression:"siteDetails.videoPullAddr"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"推流配置"}},[t("el-input",{attrs:{placeholder:"请输入推流IP地址或域名"},model:{value:e.siteDetails.videoPushAddr,callback:function(t){e.$set(e.siteDetails,"videoPushAddr",t)},expression:"siteDetails.videoPushAddr"}})],1)],1),e._e()],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.disabled?e._e():t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-success"},on:{click:function(t){return e.submit("SiteDetailsForm")}}},[e._v("确 定")]),t("el-button",{attrs:{plain:"",size:"small",icon:"el-icon-error",type:"primary"},on:{click:function(t){return e.resetForm("SiteDetailsForm")}}},[e._v("取 消")])],1)],1),t("el-dialog",{staticClass:"protective-line",attrs:{center:"",visible:e.equipmentDialogVisible,"before-close":e.handleClose,"destroy-on-close":!0}},[t("el-title",{attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.setDialogTitle)+" ")]),1===e.equipmentt?t("HiveForm",{key:e.dialogElKey+"-hiveForm",ref:e.uRefs[0],attrs:{id:e.uHiveID,equipments:e.hiveList,"component-mode":"site"},on:{handleChangeMode:e.handleChangeMode}}):2===e.equipmentt?t("DroneForm",{key:e.dialogElKey+"-uavForm",ref:e.uRefs[1],attrs:{id:e.uDroneID,"is-edit":e.isEdit,equipments:e.droneList,"component-mode":"site"},on:{handleChangeMode:e.handleChangeMode}}):t("span",{ref:e.uRefs[2]},[e._v("3")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-success"},on:{click:function(t){return e.handleSubmitEquipmentInfo(e.equipmentt)}}},[e._v("确 定")]),t("el-button",{attrs:{plain:"",size:"small",icon:"el-icon-error",type:"primary"},on:{click:function(t){return e.resetEquipmentInfoFrom(e.equipmentt)}}},[e._v("取 消")])],1)],1),t("el-dialog",{staticClass:"protective-night",attrs:{"close-on-click-modal":!1,visible:e.dialogVisible,fullscreen:!0},on:{close:function(t){e.dialogVisible=!1}}},[t("p",{staticClass:"dialog-close-tag"},[t("i",{staticClass:"el-icon-circle-close",on:{click:function(t){e.dialogVisible=!1}}})]),t("flight-tutorial",{on:{goto:e.handleTutorial}})],1),t("el-dialog",{attrs:{visible:e.mapDialog,"destroy-on-close":!0},on:{opened:function(t){return e.initModifyInteraction(e.uCoordinates,e.uMode,e.STID)},close:e.handleCloseOpenLayerMap}},[t("el-title",{attrs:{slot:"title"},slot:"title"},[e._v(" 地图定位 "),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"刷新无人机实时位置",placement:"top"}},[t("i",{staticClass:"el-icon-refresh-right",on:{click:e.handleRefresh}})])],1),t("OlMap",{ref:"OpenLayerMap",attrs:{"map-height":"50vh"},on:{getCoordinates:e.getCoordinates}})],1),t("el-drawer",{staticClass:"cropper-wrap",attrs:{visible:e.imgCropperDialogVisible,"before-close":e.handleCloseImgCropper}},[t("el-title",{attrs:{slot:"title"},slot:"title"},[e._v(" 上传图片 ")]),e.imgCropperDialogVisible?t("ImgCropper",{attrs:{"base-code":e.siteDetails.thumbnailBase64},on:{sendCropperImg:e.handleCropperImg}}):e._e()],1),t("a-modal",{attrs:{centered:"",width:"50%",title:(e.record.siteName?e.record.siteName:"")+" | 媒体服务配置","ok-text":"保存","cancel-text":"关闭","destroy-on-close":!0,visible:e.visible},on:{ok:function(t){return e.submitMediaServerConfig("MediaServerConfigForm")},cancel:e.handleCancel}},[t("el-form",{ref:"MediaServerConfigForm",attrs:{"label-position":"top","label-width":"auto",model:e.mediaServerConfig,rules:e.rules,autocomplete:"off",size:"small"}},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"储存方式",prop:"storageType"}},[t("el-select",{staticStyle:{width:"100%"},on:{change:e.handleChangeStorageType},model:{value:e.mediaServerConfig.storageType,callback:function(t){e.$set(e.mediaServerConfig,"storageType",t)},expression:"mediaServerConfig.storageType"}},e._l(e.storageTypes,(function(e){return t("el-option",{key:e.label,attrs:{value:e.value,label:e.label}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"文件重命名方式",prop:"mediaRenameType"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.mediaServerConfig.mediaRenameType,callback:function(t){e.$set(e.mediaServerConfig,"mediaRenameType",t)},expression:"mediaServerConfig.mediaRenameType"}},e._l(e.mediaRenameTypes,(function(e){return t("el-option",{key:e.label,attrs:{value:e.value,label:e.label}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"文件储存路径",prop:"storagePathFormat"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.mediaServerConfig.storagePathFormat,callback:function(t){e.$set(e.mediaServerConfig,"storagePathFormat",t)},expression:"mediaServerConfig.storagePathFormat"}},e._l(e.storagePathFormats,(function(e){return t("el-option",{key:e.label,attrs:{value:e.value,label:e.label}})})),1)],1)],1),1===e.mediaServerConfig.storageType||4===e.mediaServerConfig.storageType?[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"桶名称",prop:"storageServerInfo.bucketName"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.bucketName,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"bucketName",t)},expression:"mediaServerConfig.storageServerInfo.bucketName"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"服务器地址",prop:"storageServerInfo.endPoint"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.endPoint,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"endPoint",t)},expression:"mediaServerConfig.storageServerInfo.endPoint"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"密钥ID",prop:"storageServerInfo.accessKeyId"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.accessKeyId,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"accessKeyId",t)},expression:"mediaServerConfig.storageServerInfo.accessKeyId"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"密钥Key",prop:"storageServerInfo.secretAccessKey"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.secretAccessKey,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"secretAccessKey",t)},expression:"mediaServerConfig.storageServerInfo.secretAccessKey"}})],1)],1)]:e._e(),2===e.mediaServerConfig.storageType?[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"ftp服务器地址",prop:"storageServerInfo.ftpAddr"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.ftpAddr,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"ftpAddr",t)},expression:"mediaServerConfig.storageServerInfo.ftpAddr"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"ftp用户名",prop:"storageServerInfo.ftpUsername"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.ftpUsername,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"ftpUsername",t)},expression:"mediaServerConfig.storageServerInfo.ftpUsername"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"ftp密码",prop:"storageServerInfo.ftpPassword"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.ftpPassword,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"ftpPassword",t)},expression:"mediaServerConfig.storageServerInfo.ftpPassword"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.ftpPort"}},[t("label",{attrs:{slot:"label"},slot:"label"},[e._v(" ftp端口 "),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"端口范围0-65535",placement:"top-start"}},[t("i",{staticClass:"el-icon-warning-outline"})])],1),t("el-input",{attrs:{placeholder:"0-65535"},model:{value:e.mediaServerConfig.storageServerInfo.ftpPort,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"ftpPort",e._n("string"===typeof t?t.trim():t))},expression:"mediaServerConfig.storageServerInfo.ftpPort"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.encryption",label:"加密方式"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.mediaServerConfig.storageServerInfo.encryption,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"encryption",t)},expression:"mediaServerConfig.storageServerInfo.encryption"}},e._l(e.encryptions,(function(e){return t("el-option",{key:e.label,attrs:{value:e.value,label:e.label}})})),1)],1)],1)]:e._e(),2===e.mediaServerConfig.storageType?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.protocol",label:"协议"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.mediaServerConfig.storageServerInfo.protocol,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"protocol",t)},expression:"mediaServerConfig.storageServerInfo.protocol"}},[t("el-option",{attrs:{value:"FTP",label:"FTP"}}),t("el-option",{attrs:{value:"SFTP",label:"SFTP"}})],1)],1)],1):e._e(),3===e.mediaServerConfig.storageType?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.protocol",label:" 协议"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.mediaServerConfig.storageServerInfo.protocol,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"protocol",t)},expression:"mediaServerConfig.storageServerInfo.protocol"}},[t("el-option",{attrs:{value:"HTTP",label:"HTTP"}}),t("el-option",{attrs:{value:"HTTPS",label:"HTTPS"}})],1)],1)],1):e._e(),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.character",label:"编码字符集"}},[t("el-input",{attrs:{placeholder:"UTF-8"},model:{value:e.mediaServerConfig.storageServerInfo.character,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"character",t)},expression:"mediaServerConfig.storageServerInfo.character"}})],1)],1),3===e.mediaServerConfig.storageType?[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.token",label:"Token"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.token,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"token",t)},expression:"mediaServerConfig.storageServerInfo.token"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.uploadUrl",label:"http上传路径"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.uploadUrl,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"uploadUrl",t)},expression:"mediaServerConfig.storageServerInfo.uploadUrl"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.requestMethod",label:"请求方式"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.requestMethod,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"requestMethod",t)},expression:"mediaServerConfig.storageServerInfo.requestMethod"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.contentType",label:"数据传输方式"}},[t("el-input",{attrs:{placeholder:"multipart/form-data"},model:{value:e.mediaServerConfig.storageServerInfo.contentType,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"contentType",t)},expression:"mediaServerConfig.storageServerInfo.contentType"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.dataType",label:"数据类型"}},[t("el-input",{attrs:{placeholder:"MultipartRequest"},model:{value:e.mediaServerConfig.storageServerInfo.dataType,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"dataType",t)},expression:"mediaServerConfig.storageServerInfo.dataType"}})],1)],1)]:e._e(),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"上传完成回调地址",prop:"callBackUrl"}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入上传回调地址"},model:{value:e.mediaServerConfig.callBackUrl,callback:function(t){e.$set(e.mediaServerConfig,"callBackUrl",t)},expression:"mediaServerConfig.callBackUrl"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{prop:"storageServerInfo.baseUrl",label:"上传基地址"}},[t("el-input",{model:{value:e.mediaServerConfig.storageServerInfo.baseUrl,callback:function(t){e.$set(e.mediaServerConfig.storageServerInfo,"baseUrl",t)},expression:"mediaServerConfig.storageServerInfo.baseUrl"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"三方平台上传完成回调地址",prop:"callBackUrl"}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入上传回调地址"},model:{value:e.mediaServerConfig.mediaOtherConfig.callbackUrl,callback:function(t){e.$set(e.mediaServerConfig.mediaOtherConfig,"callbackUrl",t)},expression:"mediaServerConfig.mediaOtherConfig.callbackUrl"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"三方平台Token",prop:"callBackUrl"}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入Token"},model:{value:e.mediaServerConfig.mediaOtherConfig.callbackToken,callback:function(t){e.$set(e.mediaServerConfig.mediaOtherConfig,"callbackToken",t)},expression:"mediaServerConfig.mediaOtherConfig.callbackToken"}})],1)],1)],2)],1)],1),t("SiteDeviceSourceDialog",{attrs:{visible:e.siteDeviceSourceDialogVisible,source:e.currentSite},on:{"update:visible":function(t){e.siteDeviceSourceDialogVisible=t}}})],1)},s=[],r=(i("d9e2"),i("14d9"),i("13d5"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"tutorial-wrapper"},e._l(e.process,(function(i,a){return t("process-item",{key:a,attrs:{"img-src":i.src,title:i.title,content:i.content}},[e.isHide(i.permission)?t("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return e.$emit("goto",i.key)}}},[e._v(" "+e._s(i.btnVal)+" ")]):e._e()],1)})),1)}),o=[],l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"process-item"},[t("el-image",{attrs:{src:e.imgSrc}}),t("strong",[e._v(e._s(e.title))]),t("p",{staticClass:"process-content"},[e._v(" "+e._s(e.content)+" ")]),e._t("default")],2)},n=[],d={name:"PItem",props:{imgSrc:{type:String,default:""},title:{type:String,default:""},content:{type:String,default:""},btnVal:{type:String,default:"未知"}},data(){return{}},created(){}},c=d,p=(i("1d7d"),i("2877")),u=Object(p["a"])(c,l,n,!1,null,null,null),f=u.exports,m=i("742b"),g=i.n(m),h=i("bf90"),v=i.n(h),b=i("3f74"),I=i.n(b),A=i("e350"),S={name:"Tutorial",components:{ProcessItem:f},data(){return{process:[{src:g.a,title:"新建站点",content:"第一步：新建一个站点",btnVal:"立刻去",key:"dialogLineVisible",permission:"sitelist/sitelist/add"},{src:v.a,title:"新建设备",content:"第二步：添加每一个设备，请注意，每个设备都需要单独添加哦！",btnVal:"立刻去",key:"equipmentDialogVisible",permission:"sitelist/sitelist/update"},{src:I.a,title:"完成",content:"操作完以上两步，就可以使用啦！",btnVal:"完成",key:"dialogVisible"}]}},methods:{handleTutorialItem(e){this.$emit("handleTutorialItem",e)},isHide(e){if(e){const[t,i,a]=e.split("/");return Object(A["b"])(t,i,a)}return!0}}},C=S,D=(i("e36b"),Object(p["a"])(C,r,o,!1,null,"58f26c96",null)),y=D.exports,k=i("da01"),M=function(){var e=this,t=e._self._c;return t("div",{staticClass:"drone-infor-form-wrap"},[t("el-form",{ref:"droneInformationForm",attrs:{size:"small","label-position":"right","label-width":"110px",model:e.droneInformation,rules:e.rules,disabled:e.disabled}},[t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"无人机编号",prop:"UAVID"}},[e.equipments.length?t("InputAppend",{attrs:{type:"icon"}},[e.isAdd?t("el-input",{attrs:{disabled:e.isEdit},model:{value:e.droneInformation.UAVID,callback:function(t){e.$set(e.droneInformation,"UAVID",t)},expression:"droneInformation.UAVID"}}):t("el-select",{on:{change:e.handleChange},model:{value:e.droneInformation.UAVID,callback:function(t){e.$set(e.droneInformation,"UAVID",t)},expression:"droneInformation.UAVID"}},e._l(e.equipments,(function(e){return t("el-option",{key:e.UAVID,attrs:{value:e.UAVID,label:e.UAVID}})})),1),t("span",{attrs:{slot:"input-append"},on:{click:e.handleChangeMode},slot:"input-append"},[t("i",{staticClass:"el-icon-refresh"})])],1):t("el-input",{attrs:{disabled:e.isEdit},model:{value:e.droneInformation.UAVID,callback:function(t){e.$set(e.droneInformation,"UAVID",t)},expression:"droneInformation.UAVID"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"无人机名称",prop:"UAVName"}},[t("el-input",{model:{value:e.droneInformation.UAVName,callback:function(t){e.$set(e.droneInformation,"UAVName",t)},expression:"droneInformation.UAVName"}})],1)],1)],1),t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"机身号SN",prop:"SN"}},[t("el-input",{model:{value:e.droneInformation.SN,callback:function(t){e.$set(e.droneInformation,"SN",t)},expression:"droneInformation.SN"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"序列号FCSN",prop:"FCSN"}},[t("el-input",{model:{value:e.droneInformation.FCSN,callback:function(t){e.$set(e.droneInformation,"FCSN",t)},expression:"droneInformation.FCSN"}})],1)],1)],1),t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"无人机型号",prop:"model"}},[t("el-select",{model:{value:e.droneInformation.model,callback:function(t){e.$set(e.droneInformation,"model",t)},expression:"droneInformation.model"}},e._l(e.models,(function(e,i){return t("el-option",{key:i,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"边缘计算机",prop:"isHaveComputer"}},[t("el-select",{model:{value:e.droneInformation.isHaveComputer,callback:function(t){e.$set(e.droneInformation,"isHaveComputer",t)},expression:"droneInformation.isHaveComputer"}},[t("el-option",{attrs:{label:"有",value:1}}),t("el-option",{attrs:{label:"无",value:2}})],1)],1)],1)],1),t("el-form-item",{attrs:{label:"FLV视频流"}},[t("el-input",{model:{value:e.droneInformation.UAVFLVURL,callback:function(t){e.$set(e.droneInformation,"UAVFLVURL",t)},expression:"droneInformation.UAVFLVURL"}})],1),"site"===e.componentMode?t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"边缘计算机1"}},[t("InputAppend",{attrs:{type:"text"}},[t("el-select",{model:{value:e.droneInformation.ECID1,callback:function(t){e.$set(e.droneInformation,"ECID1",t)},expression:"droneInformation.ECID1"}},e._l(e.computerList,(function(e){return t("el-option",{key:e.ECID,attrs:{value:e.ECID,label:e.ECID}})})),1),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[t("el-tooltip",{attrs:{content:"遥控器关联的安卓设备",placement:"top",effect:"light"}},[t("i",{staticClass:"el-icon-question"})])],1)],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"边缘计算机2"}},[t("InputAppend",{attrs:{type:"text"}},[t("el-select",{model:{value:e.droneInformation.ECID2,callback:function(t){e.$set(e.droneInformation,"ECID2",t)},expression:"droneInformation.ECID2"}},e._l(e.computerList,(function(e){return t("el-option",{key:e.ECID,attrs:{value:e.ECID,label:e.ECID}})})),1),t("span",{attrs:{slot:"input-append"},slot:"input-append"},[t("el-tooltip",{attrs:{content:"无人机机载端关联的机载电脑",placement:"top",effect:"light"}},[t("i",{staticClass:"el-icon-question"})])],1)],1)],1)],1)],1):e._e()],1)],1)},E=[],x=i("61f7"),w=i("3272"),O=i("160b"),T=i("514b"),F={name:"DroneInfoForm",props:{gutter:{type:Number,default:10},disabled:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},data:{type:Object,default(){return{}}},equipments:{type:Array,default(){return[]}},siteList:{type:Array,default(){return[]}},id:{type:String,default:""},componentMode:{type:String,default:""},dialogVisible:{type:Boolean,default:!1}},data(){return{isAdd:!1,computerList:[],models:[],UAVMODELS:w["a"],deviceStatus:O["a"],droneInformation:{UAVID:"",UAVName:"",model:"",configMode:"",isHaveComputer:2,FCSN:"",SN:"",siteID:"",ECID1:"",ECID2:"",content:"",UAVFLVURL:""},rules:{UAVID:[{validator:x["d"],trigger:"blur"}],UAVName:[{required:!0,message:"请输入无人机名称",trigger:"blur"},{min:1,max:16,message:"长度在16个字符以下",trigger:"blur"}],SN:[{required:!0,validator:x["i"],trigger:"blur"}],FCSN:[{required:!0,validator:x["i"],trigger:"blur"}],siteID:[{required:!0,message:"请选择站点",trigger:"blur"}],model:[{required:!0,message:"请选择无人机型号",trigger:"blur"}],isHaveComputer:[{required:!0,message:"请选择边缘计算机配置",trigger:"blur"}]}}},created(){if(this.fetch(),this.data){const e=this.$deepClone(this.data);Object.keys(this.droneInformation).forEach(t=>{void 0===this.droneInformation[t]&&delete e[t]}),this.droneInformation=e}this.id&&this.$store.dispatch("uav/getDroneDetails",{UAVID:this.id}).then(e=>{const{data:t}=e;this.droneInformation=t}),this.dialogVisible&&this.getComputerList()},methods:{submit(e="droneInformationForm"){return new Promise((t,i)=>{this.$refs[e].validate(e=>{e?t(this.droneInformation):i(new Error("信息不全"))})})},resetForm(e="droneInformationForm"){this.$refs[e].resetFields(),this.droneInformation={}},handleChangeMode(){this.isAdd=!this.isAdd,this.droneInformation={},this.$emit("handleChangeMode",this.isAdd)},async handleChange(e){const{data:t}=await this.$store.dispatch("uav/getDroneDetails",{UAVID:e});this.droneInformation=t},async getComputerList(e=1,t=500,i=""){const{code:a,data:s,reason:r}=await this.$store.dispatch("computer/getComputerList",{page:e,size:t,ECID:i});if(!Object(T["a"])(a))return this.$message("请求失败："+r);const{list:o}=s;return this.computerList=o,o},async fetch(){try{const e=await this.$store.dispatch("device/fetch",{modelType:1});this.models=null===e||void 0===e?void 0:e.data.map(e=>({value:e.modelCode,label:e.modelName}))}catch(e){console.error(e),this.$message.error("请求无人机模型失败，请联系管理员")}}}},L=F,V=(i("f5ac"),Object(p["a"])(L,M,E,!1,null,"2db70a7b",null)),H=V.exports,U=i("22e6"),B=i("16d5"),q=i("5697"),N=i("a670"),P=i("b7c3"),R=i("fea2"),_=i("07fd"),$=i("29b2"),Q=i("ed08"),J=function(){var e=this,t=e._self._c;return t("el-form",{attrs:{size:"small",inline:!0},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{directives:[{name:"permission",rawName:"v-permission",value:"sitelist/sitelist/add",expression:"'sitelist/sitelist/add'"}],staticClass:"float-right"},[t("el-button",{attrs:{icon:"el-icon-circle-plus-outline",type:"primary"},on:{click:e.handleClickAdd}},[e._v(" 新建 ")])],1),t("el-form-item",{staticClass:"float-right",staticStyle:{"margin-right":"10px"}},[t("el-button",{attrs:{plain:"",type:"primary",icon:"el-icon-tickets"},on:{click:e.handleShowTutorial}},[e._v(" 教程 ")])],1)],1)},Y=[],K={name:"ContainerHeader",props:{handleShowTutorial:{type:Function,default:()=>{}},handleClickAdd:{type:Function,default:()=>{}}}},j=K,G=Object(p["a"])(j,J,Y,!1,null,"f522d79c",null),z=G.exports,W=function(){var e=this,t=e._self._c;return t("el-table",{attrs:{"text-align":"center",data:e.source,"header-cell-style":e.skyHeadStyle,"row-class-name":e.skyTableRowClassName,"cell-style":e.skyRowStyle,height:"100px"}},[t("template",{slot:"empty"},[t("NoResult",{attrs:{"has-margin":!1}})],1),t("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),t("el-table-column",{attrs:{label:"编号｜名称",prop:"siteID","show-overflow-tooltip":"",width:"200"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[e._v(" "+e._s(i.siteID)+" "),t("br"),e._v(" "+e._s(i.siteName)+" ")]}}])}),t("el-table-column",{attrs:{label:"地址",prop:"siteAddress","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("el-link",{attrs:{type:"primary"},on:{click:function(t){e.handleOpenMap(i.siteLocation.toString(),"hivemarker",i.siteID)}}},[t("i",{staticClass:"el-icon-location"}),e._v(" "+e._s(i.siteAddress)+" ")])]}}])}),t("el-table-column",{attrs:{label:"高度信息｜单位（m）",align:"center",width:"300"},scopedSlots:e._u([{key:"default",fn:function({row:e}){return[t("AltitudeGroup",{attrs:{altitudes:{...e}}})]}}])}),t("el-table-column",{attrs:{label:"设备",align:"center",formatter:t=>e.mate(t.siteMode)}}),t("el-table-column",{attrs:{label:"飞行模式"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tag",{attrs:{size:"mini",type:1===i.row.siteSFMode?"success":"warning"}},[e._v(" "+e._s(1===i.row.siteSFMode?"孤岛模式":"跳棋模式")+" ")])]}}])}),t("el-table-column",{attrs:{label:"多机模式",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tag",{attrs:{size:"mini",type:1===i.row.isMultipleUAV?"success":"warning"}},[e._v(" "+e._s(1===i.row.isMultipleUAV?"开启":"关闭")+" ")])]}}])}),t("el-table-column",{attrs:{label:"创建时间",prop:"createTime",align:"center"}}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"450"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"sitelist/sitelist/update",expression:"'sitelist/sitelist/update'"}],attrs:{type:"text"},on:{click:function(t){return e.handleOpenSiteDeviceSourceDialog(i)}}},[e._v(" 设备 "),t("i",{staticClass:"el-icon-setting"})]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"sitelist/sitelist/config",expression:"'sitelist/sitelist/config'"}],attrs:{type:"text"},on:{click:function(t){return e.handleSetMediaServerConfig(i)}}},[e._v(" 配置 "),t("i",{staticClass:"el-icon-setting"})]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"sitelist/sitelist/edit",expression:"'sitelist/sitelist/edit'"}],attrs:{type:"text"},on:{click:function(t){return e.handleEdit(i)}}},[e._v(" 修改 "),t("i",{staticClass:"el-icon-edit"})]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"sitelist/sitelist/delete",expression:"'sitelist/sitelist/delete'"}],staticStyle:{color:"#eb5300"},attrs:{type:"text"},on:{click:function(t){return e.handleDeleteSite(i.siteID)}}},[e._v(" 删除 "),t("i",{staticClass:"el-icon-delete"})]),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleEdit(i,!0)}}},[e._v(" 详情 "),t("i",{staticClass:"el-icon-search"})])]}}])})],2)},X=[],Z=function(){var e=this,t=e._self._c;return t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:6}},[t("el-tooltip",{attrs:{content:"海拔高度",placement:"top","open-delay":500,"hide-after":1e3}},[t("el-tag",{attrs:{size:"small"}},[t("img",{attrs:{src:i("1c66"),alt:"",width:"16"}}),t("span",{staticStyle:{width:"30px",display:"inline-block","text-align":"right"}},[e._v(e._s(e.altitudes.siteHAltitude))])])],1)],1),t("el-col",{attrs:{span:6}},[t("el-tooltip",{attrs:{content:"椭球高度",placement:"top","open-delay":500,"hide-after":1e3}},[t("el-tag",{attrs:{size:"small"}},[t("img",{attrs:{src:i("18a2"),alt:"",width:"16"}}),t("span",{staticStyle:{width:"30px",display:"inline-block","text-align":"right"}},[e._v(e._s(e.altitudes.siteEllipsAltitude))])])],1)],1),t("el-col",{attrs:{span:6}},[t("el-tooltip",{attrs:{content:"相对地面高度",placement:"top","open-delay":500,"hide-after":1e3}},[t("el-tag",{attrs:{size:"small"}},[t("img",{attrs:{src:i("45d9"),alt:"",width:"15"}}),t("span",{staticStyle:{width:"30px",display:"inline-block","text-align":"right"}},[e._v(e._s(e.altitudes.siteAltitude))])])],1)],1),t("el-col",{attrs:{span:6}},[t("el-tooltip",{attrs:{content:"起飞高度",placement:"top","open-delay":500,"hide-after":1e3}},[t("el-tag",{attrs:{size:"small"}},[t("img",{attrs:{src:i("c63e"),alt:"",width:"18"}}),t("span",{staticStyle:{width:"30px",display:"inline-block","text-align":"right"}},[e._v(e._s(e.altitudes.UAVSTAltitude))])])],1)],1)],1)},ee=[],te={name:"AltitudeGroup",props:{altitudes:{type:Object,default:()=>({siteHAltitude:"--",siteEllipsAltitude:"--",siteAltitude:"--",UAVSTAltitude:"--"})}}},ie=te,ae=(i("1a95"),Object(p["a"])(ie,Z,ee,!1,null,"19cf1490",null)),se=ae.exports,re={name:"SiteSourceTable",components:{NoResult:B["a"],AltitudeGroup:se},props:{source:{type:Array,default:()=>[]},handleOpenMap:{type:Function,default:()=>{}},handleOpenEditForm:{type:Function,default:()=>{}},handleSetMediaServerConfig:{type:Function,default:()=>{}},handleEdit:{type:Function,default:()=>{}},handleDeleteSite:{type:Function,default:()=>{}},handleOpenSiteDeviceSourceDialog:{type:Function,required:!0,default:()=>{}}},computed:{SITEMODEL(){const e=[];return P["g"].SITEMODE.getAllValues().forEach(t=>{P["i"].includes(t)||e.push({value:t,label:P["g"].SITEMODE.getDescFromValue(t)})}),e}},methods:{isHide(e,t,i){return Object(A["b"])(e,t,i)},mate(e){const[{label:t}]=this.SITEMODEL.filter(t=>e===t.value);return t}}},oe=re,le=Object(p["a"])(oe,W,X,!1,null,"753aab8e",null),ne=le.exports;const de={siteID:"",siteName:"",siteAddress:"",siteLocation:"",siteMode:"",siteSFMode:"",thumbnailBase64:"",siteAltitude:"",isMultipleUAV:0,UAVSTAltitude:80,siteHAltitude:"",siteEllipsAltitude:"",siteOptionMode:1,siteOptionLocation:"",siteRHAltitude:120,siteOptionRHAltitude:"",siteRHHoverAltitude:5,siteOptionAltitude:"",siteOptionHAltitude:"",siteOptionEllipsAltitude:"",siteOptionHoverAltitude:5,videoPullAddr:"",videoPushAddr:""},ce=[{value:0,label:"关闭"},{value:1,label:"开启"}],pe=[{value:0,label:"暂无配置"},{value:1,label:"oss"},{value:2,label:"ftp"},{value:3,label:"http"},{value:4,label:"minio"}],ue=[{value:0,label:"不重命名"},{value:1,label:"根据航点序号重命名"},{value:2,label:"根据航点名称重命名"}],fe=[{value:0,label:"原路径"},{value:1,label:"增加镜头类型子目录"}],me=[{value:"show",label:"显式加密"},{value:"implicit",label:"隐式加密"},{value:"clear",label:"明文"}];var ge={name:"SiteList",components:{FlightTutorial:y,HiveForm:k["a"],DroneForm:H,OlMap:U["a"],ImgCropper:N["a"],ContainerHeader:z,SourceTable:ne,SiteDeviceSourceDialog:q["a"]},props:{role:{type:String,default:""}},data(){const e=(e,t,i)=>{if(!t)return i("服务地址不能为空");const a=/^([0-9a-zA-Z-]{1,}\.)+([a-zA-Z]{2,})$/;a.test(t)&&i(),i(new Error("地址错误"))};return{disabled:!1,gutter:10,pId:"",cpId:"",uSTID:"",uCoordinates:"",uMode:"",STID:"",uDroneID:"",uHiveID:"",dialogElKey:"",equipmentt:1,visible:!1,record:{},siteDeviceSourceDialogVisible:!1,isEdit:!1,dialogLineVisible:!1,dialogVisible:!1,equipmentDialogVisible:!1,mapDialog:!1,imgCropperDialogVisible:!1,storageTypes:pe,mediaRenameTypes:ue,storagePathFormats:fe,encryptions:me,siteList:[],hiveList:[],droneList:[],CLICKMODE:_["b"],uRefs:["HiveInfoForm","DroneInfoForm","ComputedInfoForm"],siteMode:[1,2,6,7],socketInstance:null,droneMessage:null,hiveInformation:{},droneInformation:{},multipleOptions:ce,tableConfig:{page:1,size:20,total:0,isSiteType:1},searchForm:{corporation:"",project:""},currentSite:{},siteDetails:JSON.parse(JSON.stringify(de)),mediaServerConfig:{storageType:"",mediaRenameType:"",storagePathFormat:"",storageServerInfo:{bucketName:"",endPoint:"",accessKeyId:"",secretAccessKey:"",ftpPort:"",ftpPassword:"",ftpAddr:"",ftpUsername:"",protocol:"",encryption:"",character:"UTF-8",baseUrl:"/",uploadUrl:"",token:"",requestMethod:"",contentType:"",dataType:""},mediaOtherConfig:{callbackUrl:"",callbackToken:""},callBackUrl:""},rules:{storageType:[{required:!0,message:"请选择储存方式",trigger:"change"}],mediaRenameType:[{required:!0,message:"请选择储存方式",trigger:"blur"}],storagePathFormat:[{required:!0,message:"请选择储存方式",trigger:"change"}],"storageServerInfo.bucketName":[{required:!0,message:"请输入容器名称",trigger:"blur"}],"storageServerInfo.endPoint":[{required:!0,validator:e,trigger:"blur"}],"storageServerInfo.accessKeyId":[{required:!0,message:"请输入密钥ID",trigger:"blur"}],"storageServerInfo.secretAccessKey":[{required:!0,message:"请输入密钥key",trigger:"blur"}],"storageServerInfo.ftpAddr":[{required:!0,message:"请输入ftp服务器地址",trigger:"blur"}],"storageServerInfo.ftpPassword":[{required:!0,message:"请输入ftp服务器地址",trigger:"blur"}],"storageServerInfo.ftpPort":[{required:!0,message:"请输入ftp服务器地址",trigger:"blur"}],"storageServerInfo.ftpUsername":[{required:!0,message:"请输入ftp服务器地址",trigger:"blur"}],"storageServerInfo.baseUrl":[{required:!1,message:"请输入ftp服务器地址",trigger:"blur"}],"storageServerInfo.protocol":[{required:!0,message:"请输入协议类型",trigger:"blur"}],"storageServerInfo.encryption":[{required:!0,message:"请输入加密方式",trigger:"blur"}],"storageServerInfo.character":[{required:!0,message:"请输入字符集",trigger:"blur"}],"storageServerInfo.uploadUrl":[{required:!0,message:"请输入上传路径",trigger:"blur"}],"storageServerInfo.token":[{required:!0,message:"请输入鉴权密钥（token）",trigger:"blur"}],"storageServerInfo.requestMethod":[{required:!0,message:"请输入请求方法",trigger:"blur"}],"storageServerInfo.contentType":[{required:!0,message:"请输入传输方式",trigger:"blur"}],"storageServerInfo.dataType":[{required:!0,message:"请输入数据类型",trigger:"blur"}],"mediaOtherConfig.callbackUrl":[{required:!1,message:"请输入数据类型",trigger:"blur"}],"mediaOtherConfig.callbackToken":[{required:!1,message:"请输入数据类型",trigger:"blur"}]},siteRules:{siteID:[{required:!0,validator:x["j"],trigger:"blur"}],siteName:[{required:!0,validator:x["k"],trigger:"blur"}],siteLocation:[{required:!0,validator:x["f"],trigger:"blur"}],siteMode:[{required:!0,message:"请选择站点模式",trigger:"change"}],siteSFMode:[{required:!0,message:"请选择类型",trigger:"change"}],siteOptionMode:[{required:!0,message:"请选择是否自定义备降",trigger:"change"}],siteOptionLocation:[{required:!0,validator:x["f"],trigger:"blur"}],siteAltitude:[{required:!0,validator:x["e"],trigger:"blur"}],UAVSTAltitude:[{required:!0,validator:x["e"],trigger:"blur"}],siteHAltitude:[{required:!0,validator:x["e"],trigger:"blur"}],siteEllipsAltitude:[{required:!0,validator:x["e"],trigger:"blur"}],siteRHAltitude:[{required:!0,validator:x["e"],trigger:"blur"}],siteOptionRHAltitude:[{required:!0,validator:x["e"],trigger:"blur"}],siteRHHoverAltitude:[{required:!0,validator:x["c"],trigger:"blur"}],siteOptionAltitude:[{required:!0,validator:x["e"],trigger:"blur"}],siteOptionHAltitude:[{required:!0,validator:x["e"],trigger:"blur"}]},numberKey:{siteAltitude:"",UAVSTAltitude:"",siteHAltitude:"",siteEllipsAltitude:"",siteRHAltitude:"",siteOptionRHAltitude:"",siteRHHoverAltitude:"",siteOptionAltitude:"",siteOptionHAltitude:"",siteOptionEllipsAltitude:"",siteOptionHoverAltitude:""},bkgSiteDetails:{}}},computed:{setDialogTitle(){return`${this.isEdit?"绑定":"新建"}${1===this.equipmentt?"机库":"无人机"}`},hasRole(){return"admin"===this.role},SITEMODEL(){const e=[];return P["g"].SITEMODE.getAllValues().forEach(t=>{P["i"].includes(t)||e.push({value:t,label:P["g"].SITEMODE.getDescFromValue(t)})}),e}},watch:{equipmentDialogVisible(){this.dialogElKey=Math.random()},"mediaServerConfig.storageType":function(e,t){this.onChangeStorageTypeMediaServerConfigValidate_1_4(1===e||4===e),this.onChangeStorageTypeMediaServerConfigValidate_2(2===e),this.onChangeStorageTypeMediaServerConfigValidate_3(3===e)},siteDeviceSourceDialogVisible(e){!1===e&&this.getSiteList(this.tableConfig)}},created(){this.getSiteList(this.tableConfig),this.getHiveList(),this.getDroneList(),this.socketConnect()},methods:{isHide(e,t,i){return Object(A["b"])(e,t,i)},headStyle(){return"text-align:center;background:#F4F7FD"},rowStyle(){return"text-align:center"},tableRowClassName({rowIndex:e}){return e%2===0?"even-number":"uneven-number"},handleChangeCPage(e){this.tableConfig.page=e,this.getSiteList(this.tableConfig)},handleTutorial(e){this[e]=!0,this.dialogVisible=!1},setEditModel(e){this.isEdit=e},handleChangeMode(e){this.isEdit=!e},handleClickAdd(){this.dialogLineVisible=!0},mate(e){const[{label:t}]=this.SITEMODEL.filter(t=>e===t.value);return t},async handleAddEquipment(e,t,i){if(this.uSTID=i,this.equipmentt=e,!t)return this[1===e?"uHiveID":"uDroneID"]=t,this.isEdit=!0,void(this.equipmentDialogVisible=!0);const a=1===e?await this.$store.dispatch("hive/getHiveDetails",{hiveID:t}):await this.$store.dispatch("uav/getDroneDetails",{UAVID:t});this.$confirm("请选择操作方式","提示",{confirmButtonText:"编辑",cancelButtonText:"解绑设备",distinguishCancelAndClose:!0,type:"warning"}).then(()=>{this.isEdit=!0,t?this[1===e?"uHiveID":"uDroneID"]=t:(this.isEdit=!1,this[1===e?"uHiveID":"uDroneID"]=""),this.equipmentt=e,this.equipmentDialogVisible=!0}).catch(async t=>{if("cancel"===t){const t=this.formatSubmitInformation(a.data,"",!0,1===e?"HIVEINFO_TEMPLATE":"UAVINFO_TEMPLATE"),{code:i,reason:s}=1===e?await this.$store.dispatch("hive/updateHiveDetails",t):await this.$store.dispatch("uav/editDroneDetails",t);if(!Object(T["a"])(i))return this.$message.error("设备解绑失败"+s);this.getSiteList(this.tableConfig),this.$message({type:"info",message:"设备已解绑"})}return""})},handleClose(){this.$confirm("确认关闭？").then(()=>{this.resetEquipmentInfoFrom(this.equipmentt)}).catch(()=>{})},handleOpenSiteDeviceSourceDialog(e){this.currentSite=e,this.siteDeviceSourceDialogVisible=!0},handleOpenMap(e,t,i){this.uCoordinates=e,this.uMode=t,this.STID=i,this.mapDialog=!0},handleRefresh(){this.initModifyInteraction(this.uCoordinates,this.uMode,this.STID)},initModifyInteraction(e,t,i){"hivemarker"!==t&&this.$refs.OpenLayerMap.setupMapClick(t),this.$refs.OpenLayerMap.setCoordinatestoMap(e.split(","),t),new Promise(e=>{this.socketInstance.on(i+" state",t=>{1===t.type&&e(t)})}).then(e=>{this.socketInstance.removeEventListener(i+" state"),this.droneMessage=e;const{latitudeWGS:t,longitudeWGS:a}=this.droneMessage;0!==t&&0!==a&&this.$refs.OpenLayerMap.setCoordinatestoMap([a,t],"dronemarker")})},getCoordinates(e){this.uCoordinates=e.lnglat.map(e=>e.toFixed(7)).join(","),this.siteDetails[e.key]=JSON.parse(JSON.stringify(e.lnglat)).map(e=>e.toFixed(7)).join(","),this.$refs.SiteDetailsForm.validateField(e.key)},handleCloseOpenLayerMap(){this.mapDialog=!1},handleCloseImgCropper(){this.imgCropperDialogVisible=!1},handleCropperImg(e){const{close:t,base64:i}=e;this.siteDetails.thumbnailBase64=i,t&&this.handleCloseImgCropper()},handleShowTutorial(){this.dialogVisible=!0},async handleSetMediaServerConfig(e){var t,i,a,s;this.record=e;const r=await this.$store.dispatch("site/fetchMediaConfig",{id:e.siteID}),o={1:"ossConfig",2:"ftpConfig",3:"httpConfig",4:"minio"},{code:l,data:n,reason:d}=r;if(!Object(T["a"])(l))return;this.mediaServerConfig.storageType=n.storageType,this.mediaServerConfig.callBackUrl=n.callBackUrl,this.mediaServerConfig.mediaRenameType=null===n||void 0===n||null===(t=n.mediaOtherConfig)||void 0===t?void 0:t.mediaRenameType,this.mediaServerConfig.storagePathFormat=null===n||void 0===n||null===(i=n.mediaOtherConfig)||void 0===i?void 0:i.storagePathFormat,this.mediaServerConfig.mediaOtherConfig.callbackUrl=(null===n||void 0===n||null===(a=n.mediaOtherConfig)||void 0===a?void 0:a.callbackUrl)||"",this.mediaServerConfig.mediaOtherConfig.callbackToken=(null===n||void 0===n||null===(s=n.mediaOtherConfig)||void 0===s?void 0:s.callbackToken)||"";const c={...this.mediaServerConfig.storageServerInfo,...n[o[this.mediaServerConfig.storageType]]};"ossConfig"===o[this.mediaServerConfig.storageType]&&(c.endPoint=c.endpoint),this.mediaServerConfig.storageServerInfo=c,this.visible=!0},submitMediaServerConfig(e){this.$refs[e].validate(async e=>{if(e){const e=await this.$store.dispatch("site/updateMediaConfig",{siteID:this.record.siteID,...this.mediaServerConfig});if(!Object(T["a"])(e.code))return;this.$message.success(e.reason),this.initMidelConfigForm("MediaServerConfigForm")}})},handleCancel(){this.initMidelConfigForm("MediaServerConfigForm")},initMidelConfigForm(e){this.$refs[e].resetFields(),this.visible=!1},async handleEdit(e,t){var i;this.disabled=t;const{code:a,data:s,reason:r}=await this.$store.dispatch("site/getSiteDetail",{siteID:e.siteID});if(!Object(T["a"])(a))return this.$message.error("站点详情获取失败："+r);this.uDroneID=null===(i=s.UAVInfo)||void 0===i?void 0:i.UAVID,this.isEdit=!0;const o=this.$deepClone(s);return Object.keys(this.siteDetails).forEach(e=>{Array.isArray(o[e])&&0!==o[e].length?this.siteDetails[e]=o[e].join(","):this.siteDetails[e]=o[e]}),this.bkgSiteDetails=this.$deepClone(this.siteDetails),console.log(this.siteDetails),this.dialogLineVisible=!0,""},handleDeleteSite(e){this.$confirm("此操作将该站点, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const{code:t,reason:i}=await this.$store.dispatch("site/deleteSite",{siteID:e});return Object(T["a"])(t)?(this.$message({type:"success",message:"删除成功!"}),this.getSiteList(this.tableConfig),""):this.$message.error("删除失败："+i)}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},cascaderValueChange(e){e.length>0?1===e.length?this.pId=e[0]:(this.cpId=e[0],this.pId=e[1]):this.pId="",this.$emit("pId",this.pId)},handleSubmitEquipmentInfo(e){if("number"!==typeof e||!e)throw new Error("请传入正确的设备类型");this.$refs[this.uRefs[e-1]].submit().then(async t=>{const i=this.formatSubmitInformation(t,this.uSTID,this.isEdit,1===e?"HIVEINFO_TEMPLATE":"UAVINFO_TEMPLATE"),a=this.isEdit?await this.$store.dispatch(1===e?"hive/updateHiveDetails":"uav/editDroneDetails",i):await this.$store.dispatch(1===e?"hive/addHiveInfo":"uav/addDroneInfo",i);return Object(T["a"])(a.code)?(this.$message.success("成功"),this.getSiteList(this.tableConfig),this.resetEquipmentInfoFrom(e),""):this.$message.error(""+a.reason)}).catch(()=>{this.$message.error(`请正确完善${1===e?"机库":"无人机"}信息`)})},formatSubmitInformation(e,t,i,a="HIVEINFO_TEMPLATE"){const s={};return Object.keys(R["a"][a]).forEach(t=>{s[t]=e[t]}),s.siteID=t,i&&(s[1===this.equipmentt?"newHiveID":"newUAVID"]=s[1===this.equipmentt?"hiveID":"UAVID"]),s},appendKey(){},submit(e){this.$refs[e].validate(async t=>{if(t){const t=this.$deepClone(this.siteDetails),{siteLocation:i,siteOptionLocation:a}=this.siteDetails;t.siteLocation=i?i.split(",").map(Number):[],t.siteOptionLocation=a?a.split(",").map(Number):"",Object.keys(t).forEach(e=>{t[e]||delete t[e]}),Object.keys(this.numberKey).forEach(e=>{t[e]&&(t[e]=parseFloat(t[e]))}),t.siteOptionMode=this.siteDetails.siteOptionMode;const{code:s,reason:r}=this.isEdit?await this.$store.dispatch("site/updateSiteDetails",t):await this.$store.dispatch("site/appendSite",t),o=Object(T["a"])(s);if(this.$message[o?"success":"error"](`${this.isEdit?"修改":"新建"}站点信息 ${o?"成功":"失败"}：${r}`),!o)throw new Error("error");this.getSiteList(this.tableConfig),this.resetForm(e)}return!1})},resetForm(e){this.uDroneID="",this.dialogLineVisible=!1,this.isEdit=!1,this.disabled=!1,this.$refs[e].resetFields(),this.siteDetails=JSON.parse(JSON.stringify(de)),this.bkgSiteDetails={}},resetEquipmentInfoFrom(e){this.equipmentDialogVisible=!1,this.$refs[this.uRefs[e-1]].resetForm()},async getSiteList({page:e,size:t,PID:i="",siteIDs:a="",isSiteType:s=1}){const{code:r,data:o,reason:l}=await this.$store.dispatch("site/getSiteList",{page:e,size:t,PID:i,isSiteType:s,siteIDs:a});if(!Object(T["a"])(r))return this.$message.error("请求失败："+l);const{list:n,total:d}=o;this.siteList=n.reduce((e,t)=>(this.siteMode.includes(t.siteMode)&&e.push(t),e),[]),this.tableConfig.total=void 0===d?this.tableConfig.total:d||0},async getHiveList(){const{code:e,data:t,reason:i}=await this.$store.dispatch("hive/getHiveList",{page:1,size:500});if(!Object(T["a"])(e))return this.$message.error("获取机库列表失败："+i);const{list:a}=t;return this.hiveList=a,a},async getDroneList(){const{code:e,data:t,reason:i}=await this.$store.dispatch("uav/getDroneList",{page:1,size:500});if(!Object(T["a"])(e))return this.$message.error("获取无人机列表失败："+i);const{list:a}=t;return this.droneList=a,a},async fetchMediaConfig(e){var t;const i=await this.$store.dispatch("site/fetchMediaConfig",{id:e});var a;if(null!==(t=i.data)&&void 0!==t&&t.ftpConfig)return null===(a=i.data)||void 0===a?void 0:a.ftpConfig},socketConnect(){const e=Object(Q["a"])("socketIOConfig");this.socketInstance=$["a"].initSocket(e)},onChangeStorageTypeMediaServerConfigValidate_1_4(e){this.rules["storageServerInfo.bucketName"][0].required=e,this.rules["storageServerInfo.endPoint"][0].required=e,this.rules["storageServerInfo.accessKeyId"][0].required=e,this.rules["storageServerInfo.secretAccessKey"][0].required=e},onChangeStorageTypeMediaServerConfigValidate_2(e){this.rules["storageServerInfo.ftpAddr"][0].required=e,this.rules["storageServerInfo.ftpPassword"][0].required=e,this.rules["storageServerInfo.ftpPort"][0].required=e,this.rules["storageServerInfo.ftpUsername"][0].required=e,this.rules["storageServerInfo.protocol"][0].required=e,this.rules["storageServerInfo.encryption"][0].required=e,this.rules["storageServerInfo.character"][0].required=e},onChangeStorageTypeMediaServerConfigValidate_3(e){this.rules["storageServerInfo.protocol"][0].required=e,this.rules["storageServerInfo.uploadUrl"][0].required=e,this.rules["storageServerInfo.token"][0].required=e},handleChangeStorageType(){},handleChangeSiteOptionModeType(e){0===e?(this.$message.warning("系统自动生成备降信息!"),this.siteDetails.siteOptionLocation=this.bkgSiteDetails.siteOptionLocation):this.siteDetails.siteOptionLocation=""}}},he=ge,ve=(i("fff1"),Object(p["a"])(he,a,s,!1,null,"05fd0e7d",null));t["default"]=ve.exports},"742b":function(e,t,i){e.exports=i.p+"img/start_icon.c4b79808.png"},"79f7":function(e,t,i){},aedc:function(e,t,i){},bf90:function(e,t,i){e.exports=i.p+"img/midway_icon.e3aa84e4.png"},c63e:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAADh0lEQVR4nO2az3HTQBTGnxIOcMJUQFIB6SCmAsyFMFwSV0BSgZ0KSCqwuTCQCylBVIA7QHRgX4ADg/itbWn851laZR8ZbOk382Y39urbt5822t0okdScxgCi1jQGELWmMYCoNV4GvB6kZ39EejRO9kUuPnSjER/vBIypmPngB1Qzxg9Enu+KCYUGKIPP2BkTNhpQMPiMnTBBNcBj8Blbb8KaARUGn1Fqwtkgbf2YaXaIhPYvi9prWGhoLBngOfgJ8ZhYpNCEk0F6noq8o5qR3HSjQ0pvLDQ0ImLKq0HaofhMLDKhQUzHL6hnXBIHInJKLLIxIbRjETkmcmgbUXhjoaGRC9DBUJYHNeGutn/PplyPyLik477SXvaYBR+7USwr0DaWwOQtNDRygZXpPx28m9J03BfFAAG+G8rcBIS+f+pGB6JAu1gCk7fQ0FgSoBN3t48Y/K0bPPVVYxy5AQ73fSrSeiQyHHajMR+tgW4sgclbaGiUCsyfvrGIPCMmTPMjpnkiFbBI3kJDw1uAO91+KDLadJeLsEjeQkMjWMAHi+QtNDSCBXywSN5CQyNYwAeL5C00NLwE6LxDcUrjmKXumnoluD6WwOQtNDRKBd4M0iM2Q1+pTmEV6LIKDKUCFslbaGiUCtBxXzZshHxBI5bA5C00NEoF6LgvjQGNAT0io14GsAMsPAv4oCUPt3TeovQiZQtO0SJyyAOJMEoF3FngJ1tgEnjKj/kpkbo3GwwI5l4McDgTfnEHLM8CFtybAaE0BjQGrBtQNXkLDQ0vATrv0PA43ZPRzWn0no8qwfWxcD2RUzV5Cw2NUoHmLFD3jRAd96UxoDGgR2TUy4B/dRZAo7TvRSw0NEoF3DaY9wKJzF6Imp0FqiZvoaHhJeBMcGcBqglLYCIVsUjeQkMjWMAHi+QtNDSCBXywSN5CQyNYwAeSHwp/VicyJiTfovTmZJBepSJvqWZU1tDwMoCVoM1KcCx7ktzlLDDfTscye5AiU307TQ4H5DCiOtWIRC54R3FFNQh0ipl3/I3qlLsk78gepFw/rrqKZFhorFJqANO3L4Ebof+ZxgCiEMWAhIsS2T6SfZHr1V8dxlKMYsA2M2b2PqHMKTWA5ec8Xf7/vK2GB+ghD/FE5pQa4J68C2eBbecLM6AtC5Qa4HAmuOWH6lbDnY9lBS8DdpnGAKLWNAYQtaYxgKg1tTfgL/E5O19sa5vXAAAAAElFTkSuQmCC"},da01:function(e,t,i){"use strict";var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"hive-infor-form-wrap"},[t("el-form",{ref:"hiveInformationForm",attrs:{size:"small","label-position":"right","label-width":"80px",model:e.hiveInfo,rules:e.rules,disabled:e.disabled}},[t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"机库编号",prop:"hiveID"}},[Boolean(e.equipments.length)?t("InputAppend",[!e.isAdd&&Boolean(e.equipments.length)?t("el-select",{on:{change:function(t){return e.handleChange(e.hiveInfo.hiveID)}},model:{value:e.hiveInfo.hiveID,callback:function(t){e.$set(e.hiveInfo,"hiveID",t)},expression:"hiveInfo.hiveID"}},e._l(e.equipments,(function(e){return t("el-option",{key:e.hiveID,attrs:{label:e.hiveID,value:e.hiveID}})})),1):t("el-input",{attrs:{disabled:e.isEdit},model:{value:e.hiveInfo.hiveID,callback:function(t){e.$set(e.hiveInfo,"hiveID","string"===typeof t?t.trim():t)},expression:"hiveInfo.hiveID"}}),t("i",{staticClass:"el-icon-refresh",attrs:{slot:"input-append"},on:{click:e.handleChangeMode},slot:"input-append"})],1):t("el-input",{attrs:{disabled:e.isEdit},model:{value:e.hiveInfo.hiveID,callback:function(t){e.$set(e.hiveInfo,"hiveID","string"===typeof t?t.trim():t)},expression:"hiveInfo.hiveID"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"机库名称",prop:"hiveName"}},[t("el-input",{model:{value:e.hiveInfo.hiveName,callback:function(t){e.$set(e.hiveInfo,"hiveName","string"===typeof t?t.trim():t)},expression:"hiveInfo.hiveName"}})],1)],1)],1),t("el-row",{attrs:{gutter:e.gutter}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"机库类型",prop:"hiveType"}},[t("el-radio",{attrs:{label:1},model:{value:e.hiveInfo.hiveType,callback:function(t){e.$set(e.hiveInfo,"hiveType",t)},expression:"hiveInfo.hiveType"}},[e._v(" 固定 ")]),t("el-radio",{attrs:{label:2},model:{value:e.hiveInfo.hiveType,callback:function(t){e.$set(e.hiveInfo,"hiveType",t)},expression:"hiveInfo.hiveType"}},[e._v(" 移动 ")])],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"机库型号",prop:"hiveModel"}},[t("el-select",{model:{value:e.hiveInfo.hiveModel,callback:function(t){e.$set(e.hiveInfo,"hiveModel",t)},expression:"hiveInfo.hiveModel"}},e._l(e.models,(function(e,i){return t("el-option",{key:i,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("el-form-item",{attrs:{label:"FLV流地址"}},[t("el-input",{model:{value:e.hiveInfo.hiveFLVURL,callback:function(t){e.$set(e.hiveInfo,"hiveFLVURL",t)},expression:"hiveInfo.hiveFLVURL"}})],1),t("el-form-item",{attrs:{label:"机库描述"}},[t("el-input",{attrs:{type:"textarea",maxlength:"200","show-word-limit":""},model:{value:e.hiveInfo.context,callback:function(t){e.$set(e.hiveInfo,"context",t)},expression:"hiveInfo.context"}})],1)],1)],1)},s=[],r=(i("d9e2"),i("14d9"),i("b7c3")),o=i("160b"),l=i("61f7"),n=i("514b"),d={name:"HiveInfoForm",props:{gutter:{type:Number,default:10},disabled:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},data:{type:Object,default(){return{}}},equipments:{type:Array,default(){return[]}},id:{type:String,default(){return""}}},data(){return{isAdd:!1,deviceStatus:o["a"],siteList:[],hiveModeList:[],hiveInfo:{hiveID:"",hiveName:"",hiveType:1,hiveModel:"",siteID:"",context:"",hiveFLVURL:""},rules:{hiveID:[{validator:l["b"],trigger:"blur"}],hiveName:[{required:!0,message:"请输入机库名称",trigger:"blur"}],hiveType:[{required:!0,message:"请选择机库类型",trigger:"change"}],hiveModel:[{required:!0,message:"请选择机库型号",trigger:"change"}],siteID:[{required:!0,message:"请选择站点",trigger:"blur"}]},models:[]}},created(){if(this.id&&this.getHiveDetails(this.id),this.data){const e=this.$deepClone(this.data);Object.keys(e).forEach(t=>{void 0===this.hiveInfo[t]&&delete e[t]}),this.hiveInfo=e}this.getHiveOptions(),this.has&&this.getSiteGroup(),this.fetch()},methods:{handleChangeMode(){this.isAdd=!this.isAdd,this.hiveInfo={},this.$emit("handleChangeMode",this.isAdd)},submit(e="hiveInformationForm"){return new Promise((t,i)=>{this.$refs[e].validate(e=>{e?t(this.hiveInfo):i(new Error("信息不全"))})})},resetForm(e="hiveInformationForm"){this.$refs[e].resetFields()},handleChange(e){this.getHiveDetails(e)},getHiveOptions(){const e=r["g"].HIVEMODEL.getAllKeys();e.forEach(e=>{this.hiveModeList.push({value:e,label:r["g"].HIVEMODEL.getDescFromValue(e)})})},async getSiteGroup(){const{code:e,data:t,reason:i}=await this.$store.dispatch("site/getSiteGroup");if(!Object(n["a"])(e))return this.$message.error("请求失败："+i);const{list:a}=t;return this.siteList=a,a},async getHiveDetails(e){const{code:t,data:i}=await this.$store.dispatch("hive/getHiveDetails",{hiveID:e});return Object(n["a"])(t)?(this.hiveInfo=i,i):this.$message.error("获取机库信息失败")},async fetch(){try{const e=await this.$store.dispatch("device/fetch",{modelType:2});this.models=e.data.map(e=>({value:e.modelCode,label:e.modelName}))}catch(e){console.error(e),this.$message.error("请求机库模型失败，请联系管理员")}}}},c=d,p=(i("30da"),i("2877")),u=Object(p["a"])(c,a,s,!1,null,"35d4985e",null);t["a"]=u.exports},dbaa:function(e,t,i){},e36b:function(e,t,i){"use strict";i("dbaa")},e872:function(e,t,i){},f5ac:function(e,t,i){"use strict";i("aedc")},fea2:function(e,t,i){"use strict";const a={hiveID:"",hiveName:"",hiveType:1,hiveModel:"",siteID:"",context:"",hiveFLVURL:""},s={UAVID:"",UAVName:"",brand:"",model:"",configMode:"",FCSN:"",SN:"",ECID1:"",ECID2:"",siteID:"",content:"",UAVFLVURL:"",isHaveComputer:2};t["a"]={HIVEINFO_TEMPLATE:a,UAVINFO_TEMPLATE:s}},fff1:function(e,t,i){"use strict";i("79f7")}}]);
//# sourceMappingURL=chunk-1a8d43de.1725872215737.js.map