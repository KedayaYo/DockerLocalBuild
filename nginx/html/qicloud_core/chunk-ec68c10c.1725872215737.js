(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ec68c10c"],{"254a":function(t,e,s){t.exports=s.p+"img/area.d68784c3.png"},"2e50":function(t,e,s){t.exports=s.p+"img/default.1f2700c4.png"},"33bf":function(t,e,s){},"45f4":function(t,e,s){},"56fe":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"mission x-scroll-white"},[e("PointTitle",{attrs:{name:"任务规划","font-style":{fontSize:"16px"}}}),e("div",{staticClass:"search"},[e("div",{staticClass:"left"},[e("a-input",{staticStyle:{width:"180px"},attrs:{placeholder:"任务名称","allow-clear":""},model:{value:t.taskName,callback:function(e){t.taskName=e},expression:"taskName"}}),e("a-select",{staticStyle:{width:"180px",margin:"0 16px"},model:{value:t.taskType,callback:function(e){t.taskType=e},expression:"taskType"}},[e("template",{slot:"suffixIcon"},[e("a-icon",{attrs:{type:"caret-down"}})],1),t._l(t.taskTypeList,(function(s){return e("a-select-option",{key:s.type,attrs:{value:s.type}},[t._v(" "+t._s(s.typeName)+" ")])}))],2),e("a-select",{staticStyle:{width:"180px","margin-right":"20px"},model:{value:t.filterSite,callback:function(e){t.filterSite=e},expression:"filterSite"}},[e("template",{slot:"suffixIcon"},[e("a-icon",{attrs:{type:"caret-down"}})],1),t._l(t.filterSiteList,(function(s){return e("a-select-option",{key:s.siteID,attrs:{value:s.siteID}},[t._v(" "+t._s(s.siteName)+" ")])}))],2),e("a-button",{attrs:{type:"primary"},on:{click:t.searchClick}},[t._v(" 查询 ")])],1),e("div",{staticClass:"right"},[e("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"route/route/add",expression:"'route/route/add'"}],attrs:{type:"primary"},on:{click:function(e){t.newVisible=!0}}},[t._v(" 新建 ")])],1)]),e("div",{staticClass:"list"},[t.taskList.length>0?e("a-row",t._l(t.taskList,(function(i){return e("a-col",{key:i.missionID},[e("div",{staticClass:"module",on:{click:function(e){return t.goToEdit(i)}}},[e("div",{staticClass:"operate-icon"},[e("a-tooltip",{directives:[{name:"permission",rawName:"v-permission",value:"route/route/copy",expression:"'route/route/copy'"}],attrs:{placement:"bottom"}},[e("template",{slot:"title"},[e("span",[t._v("复制")])]),e("a-icon",{staticClass:"copy-icon",attrs:{type:"copy"},on:{click:function(e){return e.stopPropagation(),t.copyClick(i)}}})],2),e("a-tooltip",{directives:[{name:"permission",rawName:"v-permission",value:"route/route/delete",expression:"'route/route/delete'"}],attrs:{placement:"bottom"}},[e("template",{slot:"title"},[e("span",[t._v("删除")])]),e("a-icon",{staticClass:"delete-icon",attrs:{type:"delete"},on:{click:function(e){return e.stopPropagation(),t.delClick(i)}}})],2)],1),i.thumbnailBase64?e("div",{staticClass:"thumbnail",style:{backgroundImage:`url(${i.thumbnailBase64})`}}):2===i.missionType?e("img",{attrs:{src:s("936d")}}):e("img",{attrs:{src:s("2e50")}}),e("div",{staticClass:"module-content"},[e("div",{staticClass:"name-line"},[e("a-tooltip",{attrs:{placement:"top"}},[e("template",{slot:"title"},[e("span",[t._v(t._s(i.missionName))])]),e("div",{staticClass:"task-name"},[t._v(" "+t._s(i.missionName)+" ")])],2),1===i.missionType?e("div",{staticClass:"task-type line"},[t._v(" 路点巡航 ")]):t._e(),2===i.missionType?e("div",{staticClass:"task-type area"},[t._v(" 二维扫图 ")]):t._e()],1),e("div",{staticClass:"time-line",staticStyle:{"margin-top":"6px"}},[e("span",[t._v("创建：")]),e("span",{staticClass:"time"},[t._v(t._s(i.createTime))])]),e("div",{staticClass:"time-line"},[e("span",[t._v("更新：")]),e("span",{staticClass:"time"},[t._v(t._s(i.updateTime||i.createTime))])])])])])})),1):e("NoResult")],1),t.isEnd&&t.taskList.length>0?e("div",{staticClass:"no-result"},[e("span",{staticClass:"line"}),e("span",{staticClass:"txt"},[t._v("没有更多结果")]),e("span",{staticClass:"line"})]):t._e(),e("a-modal",{staticClass:"new-task-modal",attrs:{centered:"",width:340,"mask-closable":!1},on:{cancel:function(e){t.delVisible=!1}},model:{value:t.delVisible,callback:function(e){t.delVisible=e},expression:"delVisible"}},[e("el-title",{attrs:{slot:"title"},slot:"title"},[t._v(" 删除任务 ")]),e("div",[t._v("确定删除"+t._s(t.delName)+"任务吗？")]),e("template",{slot:"footer"},[e("a-button",{staticClass:"create-btn",attrs:{type:"primary"},on:{click:t.deleteTask}},[t._v(" 确定 ")]),e("a-button",{on:{click:function(e){t.delVisible=!1}}},[t._v(" 取消 ")])],1)],2),e("a-modal",{staticClass:"new-task-modal",attrs:{centered:"",width:340,"mask-closable":!1},on:{cancel:function(e){t.siteVisible=!1}},model:{value:t.siteVisible,callback:function(e){t.siteVisible=e},expression:"siteVisible"}},[e("el-title",{attrs:{slot:"title"},slot:"title"},[t._v(" 选择站点 ")]),e("span",{staticClass:"label"},[t._v("站点")]),e("a-select",{staticStyle:{width:"160px"},model:{value:t.siteID,callback:function(e){t.siteID=e},expression:"siteID"}},[e("template",{slot:"suffixIcon"},[e("a-icon",{attrs:{type:"caret-down"}})],1),t._l(t.siteList,(function(s){return e("a-select-option",{key:s.siteID,attrs:{value:s.siteID}},[t._v(" "+t._s(s.siteName)+" ")])}))],2),e("template",{slot:"footer"},[e("a-button",{staticClass:"create-btn",attrs:{type:"primary"},on:{click:t.createTask}},[t._v(" 确定 ")]),e("a-button",{on:{click:function(e){t.siteVisible=!1}}},[t._v(" 取消 ")])],1)],2),e("TaskType",{attrs:{show:t.newVisible},on:{choseType:t.choseType,close:function(e){t.newVisible=!1}}})],1)},a=[],o=(s("14d9"),s("2f62")),n=s("2e40"),l=s("16d5"),c=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{visible:t.show,"dialog-class":"task-type",centered:"",width:546,"mask-closable":!1,footer:null},on:{cancel:function(e){return t.$emit("close")}}},[e("el-title",{attrs:{slot:"title"},slot:"title"},[t._v(" 新建任务 ")]),e("a-row",{attrs:{wrap:"",type:"flex",gutter:[24,24]}},[e("a-col",{directives:[{name:"permission",rawName:"v-permission",value:"route/route/waypoint",expression:"'route/route/waypoint'"}]},[e("div",{staticClass:"module",style:{backgroundImage:`url(${t.icon.icon2})`},on:{click:function(e){return t.$emit("choseType","line")}}},[e("div",{staticClass:"img"},[e("img",{attrs:{src:t.icon.icon1}})]),e("div",{staticClass:"detail"},[e("div",{staticClass:"type-title"},[t._v(" 路点任务 ")]),e("div",{staticClass:"desc"},[t._v(" 定义多个航点确定飞行路径 ")])])])]),e("a-col",{directives:[{name:"permission",rawName:"v-permission",value:"route/route/2d",expression:"'route/route/2d'"}]},[e("div",{staticClass:"module",style:{backgroundImage:`url(${t.icon.icon4})`},on:{click:function(e){return t.$emit("choseType","area")}}},[e("div",{staticClass:"img"},[e("img",{attrs:{src:t.icon.icon3}})]),e("div",{staticClass:"detail"},[e("div",{staticClass:"type-title"},[t._v(" 二维扫图 ")]),e("div",{staticClass:"desc"},[t._v(" 在多边形区域内自动生成 ")])])])])],1)],1)},r=[];const p=s("976a"),d=s("bdab"),m=s("254a"),u=s("cdbd");var h={props:{show:{type:Boolean,default:!1}},data(){return{icon:{icon1:p,icon2:d,icon3:m,icon4:u}}},computed:{},mounted(){},beforeMount(){}},v=h,y=(s("ebd4"),s("2877")),f=Object(y["a"])(v,c,r,!1,null,"7b2db72a",null),b=f.exports,g=s("9c23");let k=null;const _=1e3;var C={components:{PointTitle:n["a"],NoResult:l["a"],TaskType:b},data(){return{categories:g["a"],newVisible:!1,siteVisible:!1,siteID:"",siteList:[],isEnd:!1,pagination:{page:1,size:_,total:0},filterSite:"",filterSiteList:[],taskName:"",taskType:"",taskTypeList:[{type:"",typeName:"全部类型"},{type:"1",typeName:"路点巡航"},{type:"2",typeName:"二维扫图"}],delVisible:!1,delName:"",delId:"",taskList:[],thumbnailBase64:"",drawType:0}},async mounted(){this.siteList=await this.getSiteList({isSiteType:-1}),this.siteID=this.siteList[0].siteID,this.filterSiteList=[{siteID:"",siteName:"全部点位"},...this.siteList],k=document.getElementsByClassName("mission")[0],k.addEventListener("scroll",this.getScrollMore),this.search(!0)},beforeDestroy(){k.removeEventListener("scroll",this.getScrollMore),k=null},methods:{...Object(o["b"])({getSiteList:"mission/getSiteList",getMissionsList:"mission/getMissionsList",getMissionInfo:"mission/getMissionInfo",deleteMission:"mission/deleteMission",addMissions:"mission/addMissions"}),getScrollMore(){const t=document.getElementsByClassName("mission")[0],{scrollTop:e}=k,s=(document.documentElement.clientHeight||document.body.clientHeight)-document.getElementsByClassName("header")[0].clientHeight,{scrollHeight:i}=t;e+s>=i&&this.search(!1)},searchClick(){this.search(!0)},async search(t){if(t&&(this.isEnd=!1,this.pagination={page:1,size:_,total:0}),this.isEnd)return;const e={size:_,page:t?1:this.pagination.page+=1,siteID:this.filterSite,missionName:this.taskName,missionType:this.taskType};this.getMissionsList(e).then(e=>{const{list:s=[],total:i=0}=e;t?(document.getElementsByClassName("mission")[0].scrollTo(0,0),this.taskList=s||[]):this.taskList=[...this.taskList,...s]||!1,this.taskList.length>=i&&(this.isEnd=!0)})},createTask(){this.siteID?this.$router.push({path:"/route/"+this.drawType,query:{siteID:this.siteID}}):this.$message.warning("站点未选择")},async deleteTask(){const t=await this.deleteMission({missionID:this.delId});0===t&&(this.$message.success("删除成功"),this.delVisible=!1,this.search(1))},delClick(t){this.delVisible=!0;const{missionID:e,missionName:s}=t;this.delId=e,this.delName=s},async copyClick(t){const{missionID:e}=t,{code:s,data:i}=await this.getMissionInfo({missionID:e});if(0===s){const t=await this.addMissions({...i,missionName:"copy-"+i.missionName});0===t&&(this.$message.success("复制成功"),this.search(1))}},goToEdit(t){const{missionID:e,siteID:s,missionType:i}=t;this.$router.push(`/route/${2===i?"area":"line"}?siteID=${s}&id=${e}`)},choseType(t){this.newVisible=!1,this.drawType=t,this.siteVisible=!0}}},w=C,T=(s("7aa6"),Object(y["a"])(w,i,a,!1,null,"140e5cda",null));e["default"]=T.exports},"7aa6":function(t,e,s){"use strict";s("33bf")},"936d":function(t,e,s){t.exports=s.p+"img/default_area.3e32a54a.png"},"976a":function(t,e,s){t.exports=s.p+"img/point.ea755838.png"},bdab:function(t,e,s){t.exports=s.p+"img/point_bg.8a61187b.png"},cdbd:function(t,e,s){t.exports=s.p+"img/area_bg.1346dcbb.png"},ebd4:function(t,e,s){"use strict";s("45f4")}}]);
//# sourceMappingURL=chunk-ec68c10c.1725872215737.js.map